syntax = "proto3";

option cc_enable_arenas = true;

package spex;

message INavigation {

  message GetPosition {}
  message GetPositionResponse {
    double x   = 1;
    double y   = 2;
    double vx  = 4;
    double vy  = 5;
  }
  
  oneof choice {
    GetPosition positionRequest = 1;
    
    GetPositionResponse positionResponse = 2;
  }
}


message ICommutator {

  message GetTotalSlots {}
  message GetTotalSlotsResponse {
    uint32 nTotalSlots = 1;
  }

  message GetModuleInfo {
    uint32 nSlotId     = 1;
  }
  message GetAllModulesInfo {}
  message ModuleInfo {
    uint32 nSlotId     = 1;
    string sModuleType = 2;
  }

  message OpenTunnel {
    uint32 nSlotId   = 2;
  }
  message OpenTunnelSuccess {
    uint32 nTunnelId = 2;
  }
  message OpenTunnelFailed {}

  message Message {
    uint32 nTunnelId = 1;

    oneof choice {
      // All possible interfaces are listed here
      ICommutator commutator        = 2;
      INavigation navigationMessage = 3;
    }
  }

  message CloseTunnel {
    uint32 nTunnelId = 1;
  }
  message TunnelClosed {
    uint32 nTunnelId = 1;
  }

  oneof choice {
    // Requests and command from Client
    GetTotalSlots     getTotalSlots     = 1;
    GetModuleInfo     getModuleInfo     = 2;
    GetAllModulesInfo getAllModulesInfo = 3;
    OpenTunnel        openTunnel        = 4;
    CloseTunnel       closeTunnel       = 5;

    // Message could be sent in both directions
    Message           message           = 6;

    // Responces and indications from server
    ModuleInfo        moduleInfo        = 7;
    OpenTunnelSuccess openTunnelSuccess = 8;
    OpenTunnelFailed  openTunnelFailed  = 9; 
    TunnelClosed      tunnelClosed      = 10;
  }
}

